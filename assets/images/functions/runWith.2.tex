---
---

\node (f) [function] {$f$};
\node (g) [function, right=.5 of f] {\texttt{g}};
\coordinate (x) at ($ (f)!.5!(g) $);
\node (rw) at (x) [function, minimum width=2.5\masterunit, minimum height=3\masterunit] {};

\coordinate (y) at ($ (f.south io 1) + (0, -.5) $);
\node (ex) at (y -| x) [exception=MatchError];
\draw [throw ->] (f.east) -| (ex);
\draw [flow, dashed] (ex) -- (rw.south io 1);
\draw [flow ->] (rw.south io 1) -- +(0, -.5)
    node [element, below] {\false};
\draw [<- flow] (f.north io 1) -- +(0, .5) -| (rw.north io 1) -- +(0, .5)
    node [element, above] {$x$};

\node (g2) [function, left=3 of f] {\texttt{g}};
\node (f2) [function, left=.5 of g2] {$f$};

\draw [<- flow] (f2.north io 1) -- +(0, .5)
    node [element, above] {$x$};

\node (ex) [exception=MatchError, below=.5 of f2];
\draw [throw ->] (f2.west)
    -- ++(-.25, 0)
    |- ($ (f2.south io 1)!.5!(ex.north) $)
    -- (ex.north);

\draw [<- flow] (g2.north io 1) -- +(0, .5)
    node [element, above] {$y$};
\draw [flow ->] (g2.south io 1) -- +(0, -.5)
    node [element, below] {$u$};

\coordinate (x) at ($ (g2.east)!.5!(rw.west) $);
\node at (g2.west -| x) [big arrow];
